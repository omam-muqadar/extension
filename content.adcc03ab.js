var e,t;"function"==typeof(e=globalThis.define)&&(t=e,e=null),function(t,o,n,i,l){var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a="function"==typeof r[i]&&r[i],c=a.cache||{},s="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function d(e,o){if(!c[e]){if(!t[e]){var n="function"==typeof r[i]&&r[i];if(!o&&n)return n(e,!0);if(a)return a(e,!0);if(s&&"string"==typeof e)return s(e);var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}m.resolve=function(o){var n=t[e][1][o];return null!=n?n:o},m.cache={};var u=c[e]=new d.Module(e);t[e][0].call(u.exports,m,u,u.exports,this)}return c[e].exports;function m(e){var t=m.resolve(e);return!1===t?{}:d(t)}}d.isParcelRequire=!0,d.Module=function(e){this.id=e,this.bundle=d,this.exports={}},d.modules=t,d.cache=c,d.parent=a,d.register=function(e,o){t[e]=[function(e,t){t.exports=o},{}]},Object.defineProperty(d,"root",{get:function(){return r[i]}}),r[i]=d;for(var u=0;u<o.length;u++)d(o[u]);if(n){var m=d(n);"object"==typeof exports&&"undefined"!=typeof module?module.exports=m:"function"==typeof e&&e.amd?e(function(){return m}):l&&(this[l]=m)}}({bnPzj:[function(e,t,o){var n="";async function i(){async function e(e,t=5e3){let o=Date.now()+t;for(;Date.now()<o;){let t=document.querySelector(e);if(t)return t;await new Promise(e=>setTimeout(e,100))}throw Error(`Element ${e} not found within ${t}ms`)}async function t(e,t,o=5e3){let n=Date.now()+o;for(;Date.now()<n;){let o=document.querySelectorAll(e);for(let e of o)if(e.textContent.trim()===t)return e;await new Promise(e=>setTimeout(e,100))}throw Error(`Element with text "${t}" not found within ${o}ms`)}async function o(){let e=document.querySelector("tr.r7");if(!e){console.error("Target div element table not found.");return}let t=0;async function o(){let t=e.querySelector("b");if(t){let e=t.textContent.trim().split(" ")[1],o=e===n;return o?(setTimeout(()=>{chrome.runtime.sendMessage({action:"emailExists",email:n})},5e3),console.log(`Email ${n} found and message sent to background.js.`)):console.log(`Email ${n} not found in forwarded list.`),!0}return!1}let i=new MutationObserver(e=>{for(let t of e)"childList"===t.type&&o()}),l=setInterval(()=>{if(t++,console.log(`Checking for changes... (${t}s)`),t>60){console.log("Maximum time reached. Stopping the monitoring."),clearInterval(l),i.disconnect();return}i.observe(e,{childList:!0,subtree:!0}),o().then(e=>{e&&(d({action:"emailExists"}),d({action:"autoVerifyForwardEmail"}),clearInterval(l),m(),setTimeout(()=>{u("Working")},0),setTimeout(()=>{m(),window.location.replace("https://mail.google.com/mail/u/0/?tab=rm&ogbl#inbox"),window.location.reload()},1e4),i.disconnect())})},1e3);console.log("Monitoring table for changes...")}u("Working");try{let i=window.location.href;i.includes("#")?window.location.replace(i.split("#")[0]+"#settings/fwdandpop"):window.location.replace(i+"#settings/fwdandpop"),await d({action:"redirectSettings"});let l=await e('input[type="button"][value="Add a forwarding address"]');l.click(),await d({action:"clickAddForwardingAddress"});let r=await e('input[type="email"]');r.value=n.replace(/"/g,""),r.blur(),await d({action:"autoFillInputForwardingEmail"});let a=await e('button[data-mdc-dialog-action="ok"]');a.click(),t("button.mUIrbf-I","Continue").then(e=>{e.click()}).catch(e=>{console.error(e)}),await d({action:"redirectVerifyMobile"}),o()}catch(e){m(),console.error(e)}}async function l(e){async function t(t,o=5e3){let n=Date.now()+o;for(;Date.now()<n;){let o=Array.from(document.querySelectorAll("span")).find(e=>e.textContent.includes("Forwarding:"));if(console.log("spanElement",o),o){let n=o.closest("td");if(console.log("parentTd",n),!n)return console.log("No parent <td> found"),!1;{let o=n.nextElementSibling;if(console.log("nextTd",o),!o)return console.log("No next sibling <td> found"),!1;{let n=o.querySelector("select");if(console.log("selectElement",n),!n)return console.log("No select element found"),!1;{let o=Array.from(n.options),i=o.find(e=>e.textContent.includes("Remove")&&e.textContent.includes(t));if(console.log("options",o),console.log("matchedOption",i),!i)return console.log("Option not found in select options"),!1;{if(e)return!0;n.value=i.value,n.dispatchEvent(new Event("change")),i.click();let t=new MutationObserver((e,t)=>{for(let o of e)if("childList"===o.type||"subtree"===o.type){let e=document.querySelector('button[data-mdc-dialog-action="ok"]');if(e){e.click(),console.log("OK button clicked"),t.disconnect();return}}});return t.observe(document.body,{childList:!0,subtree:!0}),console.log("Option found, selected, and clicked"),!0}}}}}await new Promise(e=>setTimeout(e,100))}return console.log("Timeout expired without finding the option"),!1}try{let o=window.location.href;o.includes("#")?window.location.replace(o.split("#")[0]+"#settings/fwdandpop"):window.location.replace(o+"#settings/fwdandpop");let i=await t(n.replace(/^"|"$/g,""));return e||setTimeout(()=>{m(),o.includes("#")?window.location.replace(o.split("#")[0]+"#inbox"):window.location.replace(o+"#inbox")},2e3),i}catch(e){return!1}}chrome.runtime.onMessage.addListener(function(e,t,o){if("addForwardEmail"===e.action&&(console.log("forwardEmail",n=e.forwardEmail),u("Working"),l(!0).then(e=>{console.log("result2",e),e?(d({action:"ForwardAlreadyAdded"}),o({status:"ForwardAlreadyAdded",result:e}),setTimeout(()=>{let e=window.location.href;e.includes("#")?window.location.replace(e.split("#")[0]+"#inbox"):window.location.replace(e+"#inbox"),m()},3e3)):setTimeout(()=>{i().then(e=>{o({status:"Add Forward Email executed",result:e})}).catch(e=>{o({status:"Error",message:e.message})})},2e3)}).catch(e=>{o({status:"Error",message:e.message})})),"createFilter"===e.action&&(n=e.forwardEmail,a().then(e=>{o({status:"Create Filter executed",result:e})}).catch(e=>{o({status:"Error",message:e.message})})),"checkForwardEmail"===e.action){let e=l();e.then(e=>{o({status:e})})}if("checkFilterExistence"===e.action){let e=c();e.then(e=>{o({status:e})})}return"accountLogin"===e.action&&(s(),o({status:"Account Login executed"})),"forwardEmailVerified"===e.action&&(chrome.runtime.sendMessage({action:"forwardEmailVerified",success:!0}),o({received:!0})),"delete"===e.action&&(u("Disconnecting Email"),n=e.forwardEmail,c().then(e=>{setTimeout(()=>{l().then(e=>{e&&d({action:"ForwardRemoved"}),o({status:"Forward Email Deleted",result:e})}).catch(e=>{o({status:"Error",message:e.message})})},3e3),e&&d({action:"FilterRemoved"}),o({status:"Filter Deleted",result:e})}).catch(e=>{o({status:"Error",message:e.message})})),!0});let r=0;async function a(){if(++r<2){async function e(){let e=document.querySelector('[data-tooltip="Show search options"]');e?(e.click(),await d({action:"clickOnSearchButton"}),console.log("Search options button clicked!")):console.error("Button not found!")}async function t(){let e=document.querySelectorAll('div[role="listbox"]'),t=null;for(let o of e){let e=o.querySelector('div[role="option"]');if(e&&("Choose an address."===e.textContent.trim()||"Choose an address..."===e.textContent.trim())){t=o;break}}if(t){t.focus();let e=new MouseEvent("mousedown",{view:window,bubbles:!0,cancelable:!0});t.dispatchEvent(e),await new Promise(e=>setTimeout(e,500));let o=document.querySelectorAll("div.J-M-ayU");for(let e of(console.log("Testing Options list:",o),o)){console.log("Testing parent option:",e);let t=e.querySelectorAll('div[role="option"]');for(let e of(console.log("Testing child divs:",t),t)){console.log("Testing childDiv:",e);let t=e.querySelector("div");if(console.log("Testing emailDiv:",t),t&&t.innerText.trim()===n.replace(/^"|"$/g,"")){console.log("Testing Found matching emailDiv:",t);try{e.focus();let o=new KeyboardEvent("keydown",{key:"ArrowDown",bubbles:!0}),n=new KeyboardEvent("keydown",{key:"Enter",bubbles:!0}),i=new MouseEvent("mousedown",{view:window,bubbles:!0,cancelable:!0}),l=e.dispatchEvent(i);console.log("Testing Step 2: Mousedown event dispatched. Result:",l),e.dispatchEvent(o),e.dispatchEvent(n);let r=e.click();console.log("Testing manualmousedownresult",r),t.click();try{let t=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}),o=new MouseEvent("mouseup",{bubbles:!0,cancelable:!0}),n=new MouseEvent("click",{bubbles:!0,cancelable:!0});e.dispatchEvent(t),e.dispatchEvent(o),e.dispatchEvent(n),console.log("Testing Mouse events dispatched.")}catch(e){console.error("Testing Mouse interaction failed:",e)}e.setAttribute("aria-selected","true"),e.setAttribute("aria-activedescendant",e.id),e.setAttribute("aria-posinset","2");let a=document.querySelector('div[role="listbox"]');a&&(a.setAttribute("aria-expanded","false"),a.style.display="none"),console.log("Testing Attributes manually updated to mimic manual interaction.");let c=new MouseEvent("mouseup",{view:window,bubbles:!0,cancelable:!0}),s=e.dispatchEvent(c);console.log("Testing Step 3: Mouseup event dispatched. Result:",s);let d=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}),u=e.dispatchEvent(d);if(console.log("Testing Step 4: Click event dispatched. Result:",u),s){console.log("Testing Mouse events failed, trying keyboard interaction.");let t=new KeyboardEvent("keydown",{key:"Enter",code:"Enter",keyCode:13,bubbles:!0,cancelable:!0}),o=e.dispatchEvent(t);console.log("Testing Step 5: Keydown event dispatched. Result:",o);let n=new KeyboardEvent("keyup",{key:"Enter",code:"Enter",keyCode:13,bubbles:!0,cancelable:!0}),i=e.dispatchEvent(n);console.log("Testing Step 6: Keyup event dispatched. Result:",i)}console.log("Testing Successfully interacted with:",t.innerText);break}catch(e){console.error("Error during interaction sequence:",e)}}}}console.log("No matching email was found.")}}async function o(e,t,o=5e3){let n=Date.now()+o;for(;Date.now()<n;){let o=document.querySelectorAll(e);for(let e of o)if(e.textContent.trim()===t)return e;await new Promise(e=>setTimeout(e,100))}throw Error(`Element with text "${t}" not found within ${o}ms`)}async function i(e,t=15e3){let o=Date.now()+t;for(;Date.now()<o;){let t=document.querySelectorAll("label");for(let o of t)if(o.innerText.trim()===e){let e=o.closest("span").nextElementSibling.querySelector('input[type="text"]');if(e)return e}await new Promise(e=>setTimeout(e,100))}throw Error(`Input element with label text "${e}" not found within ${t}ms`)}async function l(){o("div","Create filter").then(e=>{e.click()}).catch(e=>{console.error(e)}),function(e){let t=new MutationObserver(t=>{for(let o of t)o.addedNodes.length>0&&e(o.addedNodes)});t.observe(document.body,{childList:!0,subtree:!0})}(e=>{e.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){let o=Array.from(e.querySelectorAll("label")).find(e=>e.textContent.includes("Forward it to:"));if(o){let e=o.previousElementSibling;e&&"INPUT"===e.tagName&&"checkbox"===e.type&&(e.click(),e.checked=!0,t())}}})})}async function a(){return new Promise((e,t)=>{let o;(o=new MutationObserver(t=>{for(let i of t)"childList"===i.type&&i.addedNodes.forEach(t=>{if(t.nodeType===Node.ELEMENT_NODE&&"SPAN"===t.tagName){let i=t.querySelector("span");if(i&&"Your filter was created."===i.textContent){console.log("Found the required span!"),o.disconnect(),clearInterval(n),e(!0);return}}})})).observe(document.body,{childList:!0,subtree:!0});let n=setInterval(()=>{console.log("Checking DOM at interval...")},1e3);setTimeout(()=>{console.log("Timeout reached without finding the span."),o.disconnect(),clearInterval(n),e(!1)},6e4)})}async function c(e,t,o=15e3){let n=Date.now()+o;for(;Date.now()<n;){let o=document.querySelectorAll(e);for(let e of o)if(e.innerText.trim()===t)return e;await new Promise(e=>setTimeout(e,100))}throw Error(`Element with text "${t}" not found within ${o}ms`)}async function s(){return new Promise(e=>{let t;function o(){t&&t.disconnect()}(t=new MutationObserver(t=>{for(let n of t)"childList"===n.type&&n.addedNodes.forEach(t=>{if(t.nodeType===Node.ELEMENT_NODE&&"SPAN"===t.tagName){if("Allow popup windows to open"===t.textContent.trim()){console.log("Found the required span!"),o(),e(!0);return}console.log("Span doesn't match:",t.textContent.trim())}})})).observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{console.log("Timeout reached without finding the span."),o(),e(!1)},6e4)})}async function f(){return new Promise(e=>{let t;function o(e){return e?.trim().replace(/\s+/g," ")||""}function n(){t&&t.disconnect(),console.log("Observer disconnected!")}(t=new MutationObserver(t=>{console.log("MutationObserver triggered!"),t.forEach(t=>{"childList"===t.type&&t.addedNodes.forEach(t=>{if(t.nodeType===Node.ELEMENT_NODE){console.log("Added node detected:",t);let i="none"!==getComputedStyle(t).display&&"hidden"!==getComputedStyle(t).visibility;if(console.log("Is node visible:",i),t.shadowRoot&&(console.log("Shadow DOM detected in node:",t),function(t){t.querySelectorAll("span").forEach(t=>{console.log("Checking span in Shadow DOM:",t),"Allow popup windows to open"===o(t.textContent)&&(console.log("Found target span in Shadow DOM:",t),n(),e(!0))})}(t.shadowRoot)),"SPAN"===t.tagName&&"Allow popup windows to open"===o(t.textContent)){console.log("Found target span:",t),n(),e(!0);return}(function(t){t.querySelectorAll("span").forEach(t=>{console.log("Checking child span:",t),"Allow popup windows to open"===o(t.textContent)&&(console.log("Found target span in child nodes:",t),n(),e(!0))})})(t)}})})})).observe(document.body,{childList:!0,subtree:!0}),console.log("Observer created and started!"),setTimeout(()=>{console.log("Timeout reached without detecting the span."),n(),e(!1)},6e4)})}u("Working");try{e(),await d({action:"clickOnCreateFilterButton"});let t=await i("From");console.log("fromEmailInput",t),t.value="*@zillow.com,*@rental.zillow.com,*@rentalmanager.zillow.com,*@convo.zillow.com,*@apartments.com,*@trulia.com,*@rental.trulia.com,*@convo.trulia.com,*@zumper.com,*@hotpads.com,*@realtor.com,*@rent.com,*@apartmentfinder.com,*@rentcafe.com,*@apartmentguide.com,*@forrent.com,*@padmapper.com,*@move.com,*@oodle.com,*@livelovely.com,*@rentpath.com,*@rentjungle.com,*@walkscore.com,*@rentalhomesplus.com,*@onradpad.com,*@har.com,*@homes.com,*@avail.co,*@apartmentlist.com,*@dwellsy.com,*@redfin.com,*@craigslist.org,*@propertybase.com,*@rentals.ca,*@kijiji.ca,*@realtor.ca,*@rentfaster.ca,*@rentboard.ca,*@4rent.ca,*@viewit.ca,*@condos.ca,*@gottarent.com,*@rentseeker.ca,*@liv.rent,*@point2homes.com,*@canadarentals.com,*@miportal.ca,*@zoocasa.com,*@zolo.ca,*@bigrent.ca,*@louer.com,*@duproprio.ca,*@rentberry.com,*@sublet.com,*@rentalads.com,*@rentdigs.com",l(),o("div.T-I-atl","Create filter").then(e=>{setTimeout(()=>{e.click()},1e3)}).catch(e=>{console.error(e)}),s().then(e=>(console.log("Popups:",e),e)?(d({action:"popupsNotAllowed"}),alert("Please allow popups to continue."),console.log("Allow popups"),setTimeout(()=>{m()},2e3),!0):(console.log("No popups found."),!1)),f().then(e=>{console.log("Detection Result:",e),e?(chrome.runtime.sendMessage({action:"popupDetected",message:"The popup was detected successfully!"},e=>{console.log("Response from sidepanel.js:",e)}),setTimeout(()=>{window.location.href="https://mail.google.com",m()},4e3),console.log("Popup span successfully detected!")):console.log("Popup span not detected within the timeout.")});let n=await c("span","Continue");console.log("continueButton",n),n.click(),a().then(e=>(console.log("Filter creation result:",e),e)?(d({action:"gmailVerification"}),console.log("Your filter was created!"),setTimeout(()=>{let e=window.location.href;e.includes("#")?window.location.replace(e.split("#")[0]+"#inbox"):window.location.replace(e+"#inbox"),m()},2e3),!0):(console.log("No filter creation message found."),!1))}catch(e){console.error(e)}}}async function c(){async function e(e,t=5e3){let o=Date.now()+t;for(;Date.now()<o;){let t=Array.from(document.querySelectorAll("td.qV")).find(t=>{console.log("td",t);let o=t.textContent.trim();console.log("tdText",o);let n=o.match(/Forward to ([\w.-]+@[\w.-]+)/),i=n?n[1]:null;return console.log("Extracted email",i),i==e});if(console.log("tdElement",t),t){let e=t.closest("tr");if(e){let t=e.querySelector("td:first-child input[type='checkbox']");if(t){t.click(),t.checked=!0;let e=Array.from(document.querySelectorAll("button")).find(e=>"Delete"===e.innerText.trim());if(e){e.click();let t=new MutationObserver((e,t)=>{for(let o of e)if("childList"===o.type||"subtree"===o.type){let e=document.querySelector('button[data-mdc-dialog-action="ok"]');if(e){e.click(),console.log("OK button clicked"),t.disconnect();return}}});return t.observe(document.body,{childList:!0,subtree:!0}),!0}}}}await new Promise(e=>setTimeout(e,100))}return!1}try{let t=window.location.href;t.includes("#")?window.location.replace(t.split("#")[0]+"#settings/filters"):window.location.replace(t+"#settings/filters"),n=n.replace(/^"|"$/g,""),console.log("forwardEmail after cleaning",n);let o=await e(n);return o}catch(e){return console.error("Error:",e),!1}}async function s(){console.log("Opening Lethub login page...");let e=window.open("https://stageapp.lethub.co/#/","_blank");window.addEventListener("message",function(t){t.source===window&&"USER_ID_FROM_LOCALSTORAGE"===t.data.type&&t.data.userData.userId&&(console.log("Received message with user ID:",t.data.userData.userId),chrome.runtime.sendMessage({type:"USER_ID_FOUND",userId:t.data.userData.userId,userEmail:t.data.userData.userEmail,username:t.data.userData.username,companyName:t.data.userData.companyName,role:t.data.userData.role,token:t.data.userData.token,windowId:e}),console.log("User ID sent to sidepanel via chrome.runtime.sendMessage."))}),e.addEventListener("load",function(){console.log("Lethub login page loaded, injecting script..."),function(e,t){console.log("Injecting external script:",e);let o=t.document.createElement("script");o.src=chrome.runtime.getURL(e),t.document.head.appendChild(o),o.onload=function(){console.log("Script injected and executed."),o.remove()}}("injectedScript.js",e),function e(){let t=localStorage.getItem("userId");if(console.log("Checking for userId in localStorage:",t),t){let e={userId:t,userEmail:localStorage.getItem("userEmail"),username:localStorage.getItem("username"),companyName:localStorage.getItem("companyName"),role:localStorage.getItem("role"),token:localStorage.getItem("token")};console.log("User data found in localStorage:",e),window.postMessage({type:"USER_ID_FROM_LOCALSTORAGE",userData:e},"*")}else console.log("User data not found, retrying in 500ms..."),setTimeout(e,500)}()})}let d=e=>new Promise((t,o)=>{chrome.runtime.sendMessage(e,e=>{chrome.runtime.lastError?(console.error("Error sending message:",chrome.runtime.lastError),o(chrome.runtime.lastError)):t(e)})});function u(e){let t=document.createElement("div");t.id="extension-loading-indicator",t.innerHTML=`
    <div class="loading-spinner"></div>
    <div class="loading-message">${e}</div>
  `,t.style.cssText=`
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0px;
    left: 0px;
    background-color: rgba(0, 0, 0, 1);
    color: white;
    font-family: Arial, sans-serif;
    font-size: 24px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  `;let o=document.createElement("style");o.textContent=`
    .loading-spinner {
      border: 16px solid #f3f3f3;
      border-top: 16px solid #3498db;
      border-radius: 50%;
      width: 120px;
      height: 120px;
      animation: spin 2s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .loading-message {
      margin-top: 20px;
    }
  `,document.head.appendChild(o),document.body.appendChild(t)}function m(){let e=document.getElementById("extension-loading-indicator");e&&e.remove()}function f(){let e=document.querySelectorAll("div.ZY span");e.forEach(e=>{e.textContent.includes("Your filters are forwarding some of your email to")&&(e.closest("div.ZY").style.display="none")})}let p=new MutationObserver(e=>{for(let t of e)("childList"===t.type||"subtree"===t.type)&&f()});p.observe(document.body,{childList:!0,subtree:!0}),f(),window.addEventListener("message",function(e){e.source===window&&"USER_ID_FROM_LOCALSTORAGE"===e.data.type&&(console.log(e.data),e.data?(console.log("User Data: ",e.data.userData),chrome.runtime.sendMessage({action:"userData",success:!0,userData:e.data.userData})):console.log("No userId found in localStorage."))}),function(e){let t=document.createElement("script");t.src=chrome.runtime.getURL(e),(document.head||document.documentElement).appendChild(t),t.onload=function(){t.remove()}}("injectedScript.js")},{}]},["bnPzj"],"bnPzj","parcelRequiree875"),globalThis.define=t;